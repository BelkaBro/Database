# Домашнее задание к занятию «Репликация и масштабирование. Часть 2»

### Задание 1

Опишите основные преимущества использования масштабирования методами:

- активный master-сервер и пассивный репликационный slave-сервер; 
- master-сервер и несколько slave-серверов;
- активный сервер со специальным механизмом репликации — distributed replicated block device (DRBD);
- SAN-кластер.

*Дайте ответ в свободной форме.*

*Активный master-сервер и пассивный репликационный slave-сервер*.

В PostgreSQL активный мастер-сервер и пассивный репликационный slave-сервер являются стандартными конфигурациями для установки.
Активный мастер-сервер является основным сервером базы данных, который принимает все запросы и управляет всеми операциями записи. Он также отвечает за контроль целостности данных и обеспечение согласованности данных между различными копиями базы данных.
Пассивный репликационный slave-сервер является копией мастер-сервера и используется для обеспечения отказоустойчивости и повышения производительности. Он получает все данные и инструкции от мастер-сервера и синхронизирует свою копию базы данных с мастер-сервером. Если мастер-сервер перестает работать, репликационный slave-сервер может продолжать работу и обеспечивать доступ к данным.
Оба сервера могут работать параллельно и обмениваться данными между собой. Репликационный slave-сервер может получать изменения данных от мастер-сервера и применять их к своей копии базы данных. Это позволяет обеспечить целостность данных и доступность при отказе мастер-сервера.

*Мaster-сервер и несколько slave-серверов*.

В PostgreSQL можно иметь несколько мастер-серверов и реплицировать данные между ними. Это может быть полезно в случае, если требуется высокая доступность и отказоустойчивость. Например, можно иметь один мастер-сервер для операций чтения и несколько реплицированных мастер-серверов для операций записи.
Каждый реплицированный мастер-сервер будет получать данные и инструкции от исходного мастер-сервера и синхронизировать свою копию базы данных с ним. Если исходный мастер-сервер перестанет работать, один из реплицированных мастер-серверов может продолжить работу и обеспечивать доступ к данным.
Такая конфигурация позволяет повысить производительность и надежность системы, но требует дополнительных ресурсов для поддержания репликации и синхронизации данных между мастер-серверами.

*Активный сервер со специальным механизмом репликации — distributed replicated block device (DRBD)*.

Distributed Replicated Block Device (DRBD) — это механизм репликации блочных устройств, который позволяет создавать распределенную файловую систему с несколькими реплицированными копиями данных на разных серверах.
DRBD использует сетевое соединение между серверами для передачи блоков данных между ними. Каждый сервер в системе является как источником, так и получателем блоков данных, что обеспечивает отказоустойчивость и высокую доступность данных.
При использовании DRBD данные разбиваются на блоки и реплицируются на несколько серверов. Если один из серверов выходит из строя, другие серверы продолжают обслуживать запросы и обеспечивать доступ к данным.
DRBD может использоваться вместе с другими механизмами репликации, такими как RAID-1 (зеркалирование), чтобы обеспечить дополнительную защиту данных и отказоустойчивость.
В целом, использование DRBD позволяет создать распределенную файловую систему с высокой доступностью и отказоустойчивостью, что особенно важно для хранения больших объемов данных или критически важных приложений.

*SAN-кластер*.
SAN-кластер — это архитектура хранилища данных, которая использует сеть для объединения нескольких физических серверов в единое логическое хранилище. В SAN-кластере каждый сервер является членом кластера и имеет доступ к общим данным, которые хранятся на других серверах в кластере.
SAN-кластеры обычно используются в крупных организациях для обеспечения высокой доступности и производительности хранилища данных. Они позволяют распределить нагрузку чтения и записи между несколькими серверами, что повышает производительность системы и обеспечивает отказоустойчивость.
В SAN-кластере может быть несколько контроллеров хранения данных, каждый из которых управляет несколькими физическими дисками. Когда запрос на чтение или запись поступает на контроллер, он определяет, на каком физическом диске находятся данные, и передает запрос на этот диск. Если диск недоступен или отказал, контроллер может перенаправить запрос на другой диск в кластере.
SAN-кластеры также позволяют использовать механизмы репликации данных для обеспечения отказоустойчивости и защиты данных. Данные могут быть реплицированы между несколькими серверами в кластере, что гарантирует их сохранность в случае отказа одного из серверов.
Использование SAN-кластера позволяет повысить производительность и надежность системы хранения данных, а также упростить управление и масштабирование хранилища.


## Задание 2

Разработайте план для выполнения горизонтального и вертикального шаринга базы данных. База данных состоит из трёх таблиц: 

- пользователи (user), 
- книги (book), 
- магазины (столбцы произвольно) (store). 

Опишите принципы построения системы и их разграничение или разбивку между базами данных.

*Пришлите блоксхему, где и что будет располагаться. Опишите, в каких режимах будут работать сервера.* 

В данной БД самый большой объем будет занимать информация о книгах (авторы, названия, жанры, годы издания). И этот объем настолько велик, что именно разделу книг я бы сделал *горизонтальное масштабирование*, например, по названиям: один сервер - от А до К, второй - от Л до Т, третий - от У до Я. И если сеть магазинов не очень большая, то данные по пользователям и магазинам вполне можно уместить и на одном сервере. И в приведенной схеме все сервера поставить в режим Мастер-Мастер.

![img](https://github.com/BelkaBro/Database/blob/main/Replication/img2/270878608-638519db-2c08-43fd-a799-6967a9d8a5d1.png)

Если же сеть магазинов очень велика, то помимо горизонтального масштабирования можно применить и *вертикальный* способ. На отдельные сервера вынести, например, пользователей, т.к. в каждом районе города, да и в других городах, их может быть много. Тут можно главный сервер сделать Мастером, остальные сделать Слейв.

![img](https://github.com/BelkaBro/Database/blob/main/Replication/img2/270880354-93032bca-9d23-457f-a650-7b0e3e4798a3.png)
